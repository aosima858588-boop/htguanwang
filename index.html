<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>海豚社区 | 链上收益优化平台</title>
    <meta name="description" content="海豚社区提供专业的OKX Boost活动工具，帮助用户最大化链上收益，包含收益计算、账本管理、签到抽奖等完整功能。">
    <meta name="keywords" content="海豚社区,OKX Boost,链上赚币,质押收益,空投奖励,加密货币">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* ===== CSS重置与基础 ===== */
        :root {
            --primary-dark: #0A1128;
            --primary: #0F1B36;
            --secondary: #1C2B4A;
            --accent-teal: #00D4AA;
            --accent-blue: #4A90E2;
            --accent-purple: #8A2BE2;
            --gradient-teal: linear-gradient(135deg, #00D4AA 0%, #4ECDC4 100%);
            --gradient-blue: linear-gradient(135deg, #4A90E2 0%, #8A2BE2 100%);
            --gradient-full: linear-gradient(135deg, var(--accent-teal) 0%, var(--accent-blue) 50%, var(--accent-purple) 100%);
            
            --text-primary: #FFFFFF;
            --text-secondary: #B0B7C3;
            --text-tertiary: #7E8BB6;
            
            --success: #00E676;
            --warning: #FFC107;
            --danger: #FF5252;
            --info: #2196F3;
            
            --card-bg: rgba(28, 43, 74, 0.7);
            --card-border: rgba(0, 212, 170, 0.15);
            --card-hover: rgba(0, 212, 170, 0.05);
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --card-shadow-hover: 0 15px 40px rgba(0, 212, 170, 0.1);
            
            --radius-sm: 12px;
            --radius-md: 16px;
            --radius-lg: 24px;
            --radius-xl: 32px;
            
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-xxl: 48px;
            
            --font-heading: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-body: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            
            --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            
            --glass-bg: rgba(15, 27, 54, 0.85);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            font-size: 15px;
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--primary-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(74, 144, 226, 0.08) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(138, 43, 226, 0.08) 0%, transparent 20%),
                radial-gradient(circle at 50% 50%, rgba(0, 212, 170, 0.05) 0%, transparent 30%);
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(180deg, rgba(10, 17, 40, 0.8) 0%, transparent 50%, rgba(10, 17, 40, 0.8) 100%),
                url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zNiAxOGMtNi42MjcgMC0xMiA1LjM3My0xMiAxMnM1LjM3MyAxMiAxMiAxMiAxMi01LjM3MyAxMi0xMi01LjM3My0xMi0xMi0xMnptMCA0YzQuNDE4IDAgOCAzLjU4MiA4IDhzLTMuNTgyIDgtOCA4LTgtMy41ODItOC04IDMuNTgyLTggOC04eiIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwuMDIpIi8+PC9nPjwvc3ZnPg==');
            z-index: -1;
            pointer-events: none;
        }

        /* ===== 自定义滚动条 ===== */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(28, 43, 74, 0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient-teal);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gradient-blue);
        }

        /* ===== 容器与布局 ===== */
        .container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            padding: 0 var(--space-md);
        }

        /* ===== 顶部导航 ===== */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            z-index: 1000;
            padding: var(--space-md) var(--space-lg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition-normal);
        }

        .top-nav.scrolled {
            padding: var(--space-sm) var(--space-lg);
            box-shadow: var(--glass-shadow);
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .nav-logo {
            width: 40px;
            height: 40px;
            background: var(--gradient-full);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            position: relative;
            overflow: hidden;
        }

        .nav-logo::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(to bottom right, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(30deg);
            animation: logoShine 8s linear infinite;
        }

        @keyframes logoShine {
            0% { transform: rotate(30deg) translateX(-100%); }
            100% { transform: rotate(30deg) translateX(100%); }
        }

        .nav-brand {
            font-family: var(--font-heading);
            font-weight: 800;
            font-size: 1.4rem;
            background: var(--gradient-full);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.5px;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .nav-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: var(--space-xs);
        }

        .nav-user-id {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent-teal);
            letter-spacing: 0.5px;
        }

        .nav-ht-balance {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .nav-menu-btn {
            width: 40px;
            height: 40px;
            background: rgba(0, 212, 170, 0.1);
            border: 1px solid rgba(0, 212, 170, 0.2);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--accent-teal);
            cursor: pointer;
            transition: var(--transition-normal);
        }

        .nav-menu-btn:hover {
            background: rgba(0, 212, 170, 0.2);
            transform: rotate(90deg);
        }

        /* ===== 主内容区 ===== */
        .main-content {
            padding-top: 80px;
            padding-bottom: 90px;
            min-height: 100vh;
        }

        /* ===== 欢迎横幅 ===== */
        .welcome-banner {
            margin-bottom: var(--space-xl);
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .welcome-title {
            font-size: 1.8rem;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: var(--space-sm);
            background: var(--gradient-full);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .welcome-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: var(--space-lg);
        }

        /* ===== 快速功能网格 ===== */
        .quick-actions {
            margin-bottom: var(--space-xl);
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .action-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: var(--transition-normal);
            cursor: pointer;
        }

        .action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--gradient-full);
            transition: var(--transition-normal);
        }

        .action-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-teal);
            box-shadow: var(--card-shadow-hover);
        }

        .action-card:hover::before {
            height: 5px;
        }

        .action-icon {
            width: 56px;
            height: 56px;
            background: var(--gradient-full);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-md);
            font-size: 1.5rem;
            color: var(--primary-dark);
            position: relative;
            overflow: hidden;
        }

        .action-icon::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(to bottom right, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: rotate(45deg);
        }

        .action-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: var(--space-sm);
        }

        .action-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        /* ===== 社区介绍卡片 ===== */
        .community-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            border: 1px solid var(--card-border);
            position: relative;
            overflow: hidden;
        }

        .community-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 20%, rgba(74, 144, 226, 0.1) 0%, transparent 50%);
        }

        .community-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
            position: relative;
            z-index: 1;
        }

        .community-icon {
            width: 64px;
            height: 64px;
            background: var(--gradient-full);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--primary-dark);
        }

        .community-title {
            font-size: 1.5rem;
            font-weight: 800;
            background: var(--gradient-full);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .community-desc {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: var(--space-lg);
            position: relative;
            z-index: 1;
        }

        /* ===== 页面容器 ===== */
        .page-container {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .page-container.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ===== 指南页面 ===== */
        .guide-section {
            margin-bottom: var(--space-xl);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: var(--space-lg);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .section-title i {
            color: var(--accent-teal);
        }

        .info-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
            border: 1px solid var(--card-border);
            position: relative;
            overflow: hidden;
        }

        .info-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--gradient-full);
        }

        .info-card-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: var(--space-sm);
            color: var(--accent-teal);
        }

        .info-card-content {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .info-card-content ul, .info-card-content ol {
            padding-left: var(--space-lg);
            margin-bottom: var(--space-md);
        }

        .info-card-content li {
            margin-bottom: var(--space-xs);
        }

        .link-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-top: var(--space-md);
        }

        .link-card {
            background: rgba(0, 212, 170, 0.05);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            border: 1px solid rgba(0, 212, 170, 0.2);
            transition: var(--transition-normal);
            cursor: pointer;
            text-align: center;
        }

        .link-card:hover {
            background: rgba(0, 212, 170, 0.1);
            border-color: var(--accent-teal);
            transform: translateY(-3px);
        }

        .link-icon {
            font-size: 1.5rem;
            margin-bottom: var(--space-sm);
            color: var(--accent-teal);
        }

        .link-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .faq-item {
            background: var(--card-bg);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
            border: 1px solid var(--card-border);
            cursor: pointer;
            transition: var(--transition-normal);
        }

        .faq-item:hover {
            border-color: var(--accent-teal);
        }

        .faq-question {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: var(--text-primary);
        }

        .faq-answer {
            color: var(--text-secondary);
            line-height: 1.5;
            font-size: 0.9rem;
            margin-top: var(--space-sm);
            display: none;
        }

        .faq-item.active .faq-answer {
            display: block;
        }

        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }

        .faq-question i {
            transition: var(--transition-normal);
            color: var(--accent-teal);
        }

        /* ===== 计算器页面 ===== */
        .calculator-form {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            border: 1px solid var(--card-border);
        }

        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-label {
            display: block;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .form-input {
            width: 100%;
            padding: var(--space-md) var(--space-lg);
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--card-border);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition-normal);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-teal);
            box-shadow: 0 0 0 2px rgba(0, 212, 170, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        .form-hint {
            font-size: 0.85rem;
            color: var(--text-tertiary);
            margin-top: var(--space-xs);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        /* ===== 收益阶段展示 ===== */
        .stages-container {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            border: 1px solid var(--card-border);
        }

        .stages-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: var(--space-lg);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .stages-title i {
            color: var(--accent-teal);
        }

        .stages-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .stage-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            border-left: 4px solid var(--accent-teal);
            transition: var(--transition-normal);
        }

        .stage-item:hover {
            background: rgba(0, 212, 170, 0.05);
            transform: translateX(5px);
        }

        .stage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-sm);
        }

        .stage-name {
            font-weight: 700;
            color: var(--accent-teal);
            font-size: 1.1rem;
        }

        .stage-rate {
            font-size: 0.9rem;
            color: var(--text-secondary);
            background: rgba(0, 212, 170, 0.1);
            padding: 4px 10px;
            border-radius: 20px;
        }

        .stage-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* ===== 总收益展示 ===== */
        .total-reward-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            border: 1px solid rgba(0, 212, 170, 0.3);
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.1) 0%, rgba(74, 144, 226, 0.1) 100%);
            text-align: center;
        }

        .total-reward-label {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-sm);
        }

        .total-reward-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--accent-teal);
            margin-bottom: var(--space-md);
            text-shadow: 0 2px 10px rgba(0, 212, 170, 0.3);
        }

        .apr-display {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .apr-value {
            color: var(--accent-teal);
            font-weight: 700;
        }

        /* ===== 图表容器 ===== */
        .chart-wrapper {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
            border: 1px solid var(--card-border);
            height: 280px;
        }

        /* ===== 账本页面 ===== */
        .ledger-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
        }

        .ledger-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            text-align: center;
            border: 1px solid var(--card-border);
            transition: var(--transition-normal);
        }

        .stat-card:hover {
            border-color: var(--accent-teal);
            transform: translateY(-3px);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--accent-teal);
            margin-bottom: var(--space-xs);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .add-record-btn {
            width: 100%;
            padding: var(--space-lg);
            background: rgba(0, 212, 170, 0.1);
            border: 2px dashed rgba(0, 212, 170, 0.3);
            border-radius: var(--radius-lg);
            color: var(--accent-teal);
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            cursor: pointer;
            transition: var(--transition-normal);
            margin-bottom: var(--space-lg);
        }

        .add-record-btn:hover {
            background: rgba(0, 212, 170, 0.2);
            border-color: var(--accent-teal);
            transform: translateY(-2px);
        }

        .ledger-table-container {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-xl);
            border: 1px solid var(--card-border);
            overflow-x: auto;
        }

        .ledger-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .ledger-table th {
            padding: var(--space-md) var(--space-lg);
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            white-space: nowrap;
        }

        .ledger-table td {
            padding: var(--space-md) var(--space-lg);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .record-date {
            font-size: 0.9rem;
            color: var(--text-tertiary);
        }

        .record-amount {
            color: var(--accent-teal);
            font-weight: 600;
        }

        .record-action {
            text-align: center;
        }

        .delete-btn {
            width: 32px;
            height: 32px;
            background: rgba(255, 82, 82, 0.1);
            border: 1px solid rgba(255, 82, 82, 0.2);
            border-radius: var(--radius-sm);
            color: var(--danger);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-normal);
        }

        .delete-btn:hover {
            background: rgba(255, 82, 82, 0.2);
            transform: scale(1.1);
        }

        /* ===== 签到页面 ===== */
        .checkin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xl);
        }

        .checkin-calendar {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            border: 1px solid var(--card-border);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--space-sm);
            margin-bottom: var(--space-xl);
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            font-weight: 600;
            background: rgba(0, 0, 0, 0.2);
            transition: var(--transition-normal);
        }

        .day-header {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            background: transparent !important;
        }

        .day-checked {
            background: var(--gradient-full);
            color: var(--primary-dark);
        }

        .day-today {
            border: 2px solid var(--accent-teal);
            background: rgba(0, 212, 170, 0.1);
        }

        .checkin-rewards {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            border: 1px solid rgba(0, 212, 170, 0.3);
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.1) 0%, rgba(74, 144, 226, 0.1) 100%);
        }

        .reward-item {
            display: flex;
            justify-content: space-between;
            padding: var(--space-md) 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .reward-item:last-child {
            border-bottom: none;
        }

        .reward-label {
            color: var(--text-secondary);
        }

        .reward-value {
            color: var(--accent-teal);
            font-weight: 700;
        }

        /* ===== 抽奖页面 ===== */
        .lottery-container {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            border: 1px solid var(--card-border);
            text-align: center;
        }

        .lottery-wheel-container {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 0 auto var(--space-xl);
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            transition: transform 3s cubic-bezier(0.2, 0.8, 0.3, 1);
        }

        .wheel-segment {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: 100% 100%;
            left: 0;
            top: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-dark);
            font-weight: 700;
        }

        .wheel-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: var(--gradient-full);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            z-index: 10;
        }

        .prizes-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin-top: var(--space-xl);
        }

        .prize-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            text-align: center;
            border: 1px solid var(--card-border);
            transition: var(--transition-normal);
        }

        .prize-card:hover {
            border-color: var(--accent-teal);
            transform: translateY(-3px);
        }

        .prize-name {
            font-weight: 600;
            margin-bottom: var(--space-sm);
            font-size: 0.95rem;
        }

        .prize-value {
            color: var(--accent-teal);
            font-size: 1.2rem;
            font-weight: 800;
            margin-bottom: var(--space-xs);
        }

        .prize-probability {
            font-size: 0.8rem;
            color: var(--text-tertiary);
        }

        /* ===== 按钮样式 ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-xl);
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition-normal);
            border: none;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: var(--transition-normal);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-full);
            color: var(--primary-dark);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 212, 170, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--accent-teal);
            border: 1px solid var(--accent-teal);
        }

        .btn-secondary:hover {
            background: rgba(0, 212, 170, 0.1);
            transform: translateY(-3px);
        }

        .btn-block {
            width: 100%;
        }

        /* ===== 模态框 ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: var(--space-md);
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background: var(--glass-bg);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            max-width: 400px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            animation: slideUp 0.4s cubic-bezier(0.2, 0.8, 0.3, 1);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .modal-close {
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-normal);
            color: var(--text-secondary);
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            transform: rotate(90deg);
        }

        /* ===== 底部导航 ===== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid var(--glass-border);
            padding: var(--space-sm) var(--space-md);
            z-index: 1000;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.2);
        }

        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-xs);
            text-decoration: none;
            color: var(--text-tertiary);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            transition: var(--transition-normal);
            cursor: pointer;
            flex: 1;
            max-width: 70px;
        }

        .nav-item.active {
            color: var(--accent-teal);
            background: rgba(0, 212, 170, 0.1);
        }

        .nav-icon {
            font-size: 1.2rem;
            transition: var(--transition-normal);
        }

        .nav-label {
            font-size: 0.7rem;
            font-weight: 500;
        }

        .nav-item.active .nav-icon {
            transform: translateY(-3px);
        }

        /* ===== 空状态提示 ===== */
        .empty-state {
            text-align: center;
            padding: var(--space-xxl) var(--space-xl);
            color: var(--text-tertiary);
        }

        .empty-icon {
            width: 64px;
            height: 64px;
            background: rgba(0, 212, 170, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-lg);
            font-size: 1.8rem;
            color: var(--accent-teal);
        }

        .empty-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: var(--space-sm);
            color: var(--text-secondary);
        }

        .empty-desc {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* ===== 响应式调整 ===== */
        @media (max-width: 480px) {
            html {
                font-size: 14px;
            }
            
            .container {
                padding: 0 var(--space-sm);
            }
            
            .action-grid {
                grid-template-columns: 1fr;
            }
            
            .prizes-grid {
                grid-template-columns: 1fr;
            }
            
            .ledger-stats {
                grid-template-columns: 1fr;
            }
            
            .lottery-wheel-container {
                width: 250px;
                height: 250px;
            }
            
            .calendar-grid {
                gap: 3px;
            }
            
            .link-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-item {
                max-width: 60px;
                padding: var(--space-xs) var(--space-sm);
            }
            
            .nav-icon {
                font-size: 1.1rem;
            }
            
            .nav-label {
                font-size: 0.65rem;
            }
        }

        @media (max-width: 360px) {
            .nav-brand {
                font-size: 1.2rem;
            }
            
            .nav-user-id {
                font-size: 0.75rem;
            }
            
            .welcome-title {
                font-size: 1.5rem;
            }
            
            .nav-item {
                max-width: 55px;
            }
            
            .nav-label {
                font-size: 0.6rem;
            }
        }

        /* ===== 工具类 ===== */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mt-1 { margin-top: var(--space-sm); }
        .mt-2 { margin-top: var(--space-md); }
        .mt-3 { margin-top: var(--space-lg); }
        .mt-4 { margin-top: var(--space-xl); }
        .mb-1 { margin-bottom: var(--space-sm); }
        .mb-2 { margin-bottom: var(--space-md); }
        .mb-3 { margin-bottom: var(--space-lg); }
        .mb-4 { margin-bottom: var(--space-xl); }
        .d-none { display: none !important; }
        .d-block { display: block !important; }
        .d-flex { display: flex; }
        .justify-between { justify-content: space-between; }
        .align-center { align-items: center; }
        .flex-column { flex-direction: column; }
        .w-100 { width: 100%; }
    </style>
</head>
<body>
    <!-- 顶部导航 -->
    <nav class="top-nav">
        <div class="nav-left">
            <div class="nav-logo">
                <i class="fas fa-dolphin"></i>
            </div>
            <div class="nav-brand">海豚社区</div>
        </div>
        <div class="nav-right">
            <div class="nav-info">
                <div class="nav-user-id" id="navUserId">H000000</div>
                <div class="nav-ht-balance">
                    <i class="fas fa-coins"></i>
                    <span id="navHTBalance">0</span> HT
                </div>
            </div>
            <div class="nav-menu-btn" onclick="showFeedbackModal()">
                <i class="fas fa-comment"></i>
            </div>
        </div>
    </nav>

    <!-- 主内容区 -->
    <main class="main-content">
        <!-- 首页 -->
        <div class="container page-container active" id="page-home">
            <!-- 欢迎横幅 -->
            <section class="welcome-banner">
                <h1 class="welcome-title">链上收益优化平台</h1>
                <p class="welcome-subtitle">
                    海豚社区为您提供专业的OKX Boost活动工具，帮助您最大化链上收益。
                    从收益计算到账本管理，从每日签到到幸运抽奖，我们提供一站式解决方案。
                </p>
            </section>

            <!-- 快速功能入口 -->
            <section class="quick-actions">
                <h2 style="font-size: 1.3rem; font-weight: 700; margin-bottom: var(--space-lg); color: var(--text-primary);">
                    快速功能
                </h2>
                <div class="action-grid">
                    <div class="action-card" onclick="showPage('calculator')">
                        <div class="action-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <div class="action-title">收益计算器</div>
                        <div class="action-desc">阶梯收益精确计算，预测质押回报</div>
                    </div>
                    
                    <div class="action-card" onclick="showPage('ledger')">
                        <div class="action-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="action-title">个人账本</div>
                        <div class="action-desc">记录与分析您的链上收益</div>
                    </div>
                    
                    <div class="action-card" onclick="showPage('checkin')">
                        <div class="action-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="action-title">每日签到</div>
                        <div class="action-desc">领取HT币奖励，连续有惊喜</div>
                    </div>
                    
                    <div class="action-card" onclick="showPage('lottery')">
                        <div class="action-icon">
                            <i class="fas fa-gift"></i>
                        </div>
                        <div class="action-title">幸运抽奖</div>
                        <div class="action-desc">消耗HT币赢取丰厚奖励</div>
                    </div>
                    
                    <div class="action-card" onclick="showPage('guide')">
                        <div class="action-icon">
                            <i class="fas fa-book-open"></i>
                        </div>
                        <div class="action-title">活动指南</div>
                        <div class="action-desc">了解OKX Boost活动规则</div>
                    </div>
                    
                    <div class="action-card" onclick="showPage('faq')">
                        <div class="action-icon">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <div class="action-title">常见问题</div>
                        <div class="action-desc">解决您的问题与疑惑</div>
                    </div>
                </div>
            </section>

            <!-- 社区介绍 -->
            <section class="community-card">
                <div class="community-header">
                    <div class="community-icon">
                        <i class="fas fa-dolphin"></i>
                    </div>
                    <div class="community-title">关于海豚社区</div>
                </div>
                <p class="community-desc">
                    我们是一个专注于OKX Boost活动的社区，致力于帮助成员优化链上收益策略。
                    通过智能工具和社区协作，我们让复杂的链上操作变得简单易懂，让每个成员都能轻松参与并获得稳定收益。
                </p>
                <button class="btn btn-secondary" onclick="window.open('https://f.wps.cn/ksform/w/write/5rJjd9vy/', '_blank')">
                    <i class="fas fa-paper-plane"></i> 提交反馈建议
                </button>
            </section>

            <!-- 实时数据 -->
            <div class="ledger-stats">
                <div class="stat-card">
                    <div class="stat-value" id="homeTotalHT">0</div>
                    <div class="stat-label">HT币余额</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="homeTotalUSDT">0</div>
                    <div class="stat-label">质押USDT</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="homeTotalHEarned">0</div>
                    <div class="stat-label">获得H代币</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="homeStreakDays">0</div>
                    <div class="stat-label">连续签到</div>
                </div>
            </div>
        </div>

        <!-- 收益计算器页面 -->
        <div class="container page-container" id="page-calculator">
            <div class="welcome-banner">
                <h1 class="welcome-title">阶梯收益计算器</h1>
                <p class="welcome-subtitle">
                    根据质押USDT金额和天数，精确计算预期收益。质押天数越久，收益率越高。
                </p>
            </div>

            <div class="calculator-form">
                <div class="form-group">
                    <label class="form-label">质押USDT金额</label>
                    <input type="number" class="form-input" id="stakeAmount" placeholder="请输入质押USDT数量" value="1000" min="1">
                    <div class="form-hint">
                        <i class="fas fa-info-circle"></i> 输入您计划质押的USDT金额
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">质押天数</label>
                    <input type="number" class="form-input" id="stakeDays" placeholder="请输入质押天数" value="30" min="1">
                    <div class="form-hint">
                        <i class="fas fa-info-circle"></i> 质押天数越长，收益率越高
                    </div>
                </div>
                
                <button class="btn btn-primary btn-block" onclick="calculateStakingReward()">
                    <i class="fas fa-calculator"></i> 计算预期收益
                </button>
            </div>

            <!-- 收益阶段详情 -->
            <div class="stages-container" id="stagesContainer" style="display: none;">
                <h3 class="stages-title"><i class="fas fa-chart-line"></i> 收益阶段详情</h3>
                <div class="stages-list" id="stagesList">
                    <!-- 阶段详情通过JS动态生成 -->
                </div>
            </div>

            <!-- 总收益展示 -->
            <div class="total-reward-card" id="totalRewardContainer" style="display: none;">
                <div class="total-reward-label">预计总收益 (H代币)</div>
                <div class="total-reward-value" id="totalRewardValue">0</div>
                <div class="apr-display">
                    年化收益率: <span class="apr-value" id="aprValue">0%</span>
                </div>
            </div>

            <!-- 收益图表 -->
            <div class="chart-wrapper" id="rewardChartContainer" style="display: none;">
                <canvas id="rewardChart"></canvas>
            </div>

            <!-- 收益规则说明 -->
            <div class="stages-container">
                <h3 class="stages-title"><i class="fas fa-info-circle"></i> 质押收益规则</h3>
                <div class="stages-list">
                    <div class="stage-item">
                        <div class="stage-header">
                            <div class="stage-name">第一阶段</div>
                            <div class="stage-rate">日利率 0.5%</div>
                        </div>
                        <div class="stage-details">
                            <span>质押天数: 1-7天</span>
                        </div>
                    </div>
                    
                    <div class="stage-item">
                        <div class="stage-header">
                            <div class="stage-name">第二阶段</div>
                            <div class="stage-rate">日利率 0.6%</div>
                        </div>
                        <div class="stage-details">
                            <span>质押天数: 8-15天</span>
                        </div>
                    </div>
                    
                    <div class="stage-item">
                        <div class="stage-header">
                            <div class="stage-name">第三阶段</div>
                            <div class="stage-rate">日利率 0.8%</div>
                        </div>
                        <div class="stage-details">
                            <span>质押天数: 16-30天</span>
                        </div>
                    </div>
                    
                    <div class="stage-item">
                        <div class="stage-header">
                            <div class="stage-name">第四阶段</div>
                            <div class="stage-rate">日利率 1.0%</div>
                        </div>
                        <div class="stage-details">
                            <span>质押天数: 31-60天</span>
                        </div>
                    </div>
                    
                    <div class="stage-item">
                        <div class="stage-header">
                            <div class="stage-name">第五阶段</div>
                            <div class="stage-rate">日利率 1.2%</div>
                        </div>
                        <div class="stage-details">
                            <span>质押天数: 61天以上</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 个人账本页面 -->
        <div class="container page-container" id="page-ledger">
            <div class="welcome-banner">
                <h1 class="welcome-title">个人收益账本</h1>
                <p class="welcome-subtitle">
                    记录您的链上收益数据，跟踪收益变化，分析投资回报。
                </p>
            </div>

            <!-- 统计数据 -->
            <div class="ledger-stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalStaked">0</div>
                    <div class="stat-label">总质押USDT</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalHEarned">0</div>
                    <div class="stat-label">总获得H代币</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalBoostReward">0</div>
                    <div class="stat-label">Boost奖励</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalCommunityReward">0</div>
                    <div class="stat-label">社区奖励</div>
                </div>
            </div>

            <!-- 添加记录按钮 -->
            <button class="add-record-btn" onclick="showAddRecordModal()">
                <i class="fas fa-plus-circle"></i>
                添加收益记录
            </button>

            <!-- 账本表格 -->
            <div class="ledger-table-container" id="ledgerTableContainer">
                <table class="ledger-table" id="ledgerTable">
                    <thead>
                        <tr>
                            <th>日期</th>
                            <th>质押USDT</th>
                            <th>获得H代币</th>
                            <th>Boost奖励</th>
                            <th>社区奖励</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="ledgerBody">
                        <!-- 记录将通过JS动态生成 -->
                    </tbody>
                </table>
            </div>

            <!-- 空状态提示 -->
            <div class="empty-state" id="emptyLedgerMessage" style="display: none;">
                <div class="empty-icon">
                    <i class="fas fa-book"></i>
                </div>
                <div class="empty-title">暂无收益记录</div>
                <div class="empty-desc">
                    您还没有添加任何收益记录。<br>
                    点击上方"添加收益记录"按钮开始记录您的链上收益。
                </div>
            </div>

            <!-- 收益趋势图表 -->
            <div class="chart-wrapper">
                <canvas id="ledgerChart"></canvas>
            </div>
        </div>

        <!-- 签到页面 -->
        <div class="container page-container" id="page-checkin">
            <div class="welcome-banner">
                <h1 class="welcome-title">每日签到</h1>
                <p class="welcome-subtitle">
                    每日签到领取HT币奖励，连续签到可获得额外惊喜奖励。
                </p>
            </div>

            <div class="checkin-header">
                <div>
                    <div style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: var(--space-xs);">
                        今日状态
                    </div>
                    <div style="font-size: 1.1rem; font-weight: 700; color: var(--accent-teal);" id="checkinStatus">
                        等待签到
                    </div>
                </div>
                <div>
                    <div style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: var(--space-xs);">
                        连续签到
                    </div>
                    <div style="font-size: 1.1rem; font-weight: 700; color: var(--accent-teal);" id="checkinStreak">
                        0 天
                    </div>
                </div>
            </div>

            <!-- 签到日历 -->
            <div class="checkin-calendar">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-lg);">
                    <div style="font-size: 1.1rem; font-weight: 700;">本月签到日历</div>
                    <div style="font-size: 0.9rem; color: var(--text-tertiary);" id="currentMonth">
                        正在加载...
                    </div>
                </div>
                
                <div class="calendar-grid" id="calendarGrid">
                    <!-- 日历格子将通过JS生成 -->
                </div>
                
                <button class="btn btn-primary btn-block" id="checkinBtn" onclick="performCheckin()">
                    <i class="fas fa-check"></i> 今日签到
                </button>
            </div>

            <!-- 签到奖励说明 -->
            <div class="checkin-rewards">
                <div style="font-size: 1.1rem; font-weight: 700; margin-bottom: var(--space-lg); color: var(--text-primary);">
                    签到奖励规则
                </div>
                <div class="reward-item">
                    <div class="reward-label">每日签到奖励</div>
                    <div class="reward-value">500 HT</div>
                </div>
                <div class="reward-item">
                    <div class="reward-label">连续15天额外奖励</div>
                    <div class="reward-value">3,000 HT</div>
                </div>
                <div class="reward-item">
                    <div class="reward-label">连续30天额外奖励</div>
                    <div class="reward-value">5,000 HT</div>
                </div>
            </div>
        </div>

        <!-- 抽奖页面 -->
        <div class="container page-container" id="page-lottery">
            <div class="welcome-banner">
                <h1 class="welcome-title">幸运抽奖</h1>
                <p class="welcome-subtitle">
                    消耗HT币参与抽奖，赢取丰厚H代币奖励。每次抽奖消耗100HT，不限制次数。
                </p>
            </div>

            <!-- 抽奖转盘 -->
            <div class="lottery-container">
                <div style="font-size: 1.1rem; font-weight: 700; margin-bottom: var(--space-md);">
                    幸运大转盘
                </div>
                <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: var(--space-lg);">
                    每次消耗 <span style="color: var(--accent-teal); font-weight: 700;">100 HT</span>
                </div>
                
                <div class="lottery-wheel-container">
                    <div class="wheel-pointer"></div>
                    <div class="wheel" id="wheel">
                        <!-- 转盘分段将通过JS生成 -->
                    </div>
                </div>
                
                <div style="display: flex; gap: var(--space-md); margin-bottom: var(--space-lg);">
                    <button class="btn btn-primary" id="spinBtn" onclick="spinWheel()" style="flex: 1;">
                        <i class="fas fa-play"></i> 抽一次
                    </button>
                    <button class="btn btn-secondary" id="spin10Btn" onclick="spinWheel(10)" style="flex: 1;">
                        <i class="fas fa-forward"></i> 抽十次
                    </button>
                </div>
                
                <div style="background: rgba(0, 0, 0, 0.2); border-radius: var(--radius-md); padding: var(--space-md); margin-bottom: var(--space-lg);">
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-secondary);">当前HT余额</span>
                        <span style="color: var(--accent-teal); font-weight: 700;" id="lotteryHTBalance">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: var(--space-xs);">
                        <span style="color: var(--text-secondary);">今日抽奖次数</span>
                        <span style="color: var(--accent-teal); font-weight: 700;" id="todaySpins">0</span>
                    </div>
                </div>
            </div>

            <!-- 奖品展示 -->
            <div class="stages-container">
                <h3 class="stages-title"><i class="fas fa-gift"></i> 奖品设置</h3>
                <div class="prizes-grid" id="prizesGrid">
                    <!-- 奖品展示通过JS生成 -->
                </div>
            </div>

            <!-- 抽奖记录 -->
            <div class="ledger-table-container">
                <div style="font-size: 1.1rem; font-weight: 700; margin-bottom: var(--space-lg);">
                    近期抽奖记录
                </div>
                <table style="width: 100%; border-collapse: collapse;" id="lotteryHistoryTable">
                    <thead>
                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <th style="padding: var(--space-sm) 0; text-align: left; font-weight: 600; color: var(--text-secondary);">时间</th>
                            <th style="padding: var(--space-sm) 0; text-align: left; font-weight: 600; color: var(--text-secondary);">奖品</th>
                            <th style="padding: var(--space-sm) 0; text-align: right; font-weight: 600; color: var(--text-secondary);">H代币</th>
                        </tr>
                    </thead>
                    <tbody id="lotteryHistoryBody">
                        <!-- 抽奖记录通过JS动态生成 -->
                    </tbody>
                </table>
                <div class="empty-state" id="emptyLotteryHistory" style="padding: var(--space-xl) 0;">
                    <div class="empty-icon">
                        <i class="fas fa-gift"></i>
                    </div>
                    <div class="empty-title">暂无抽奖记录</div>
                    <div class="empty-desc">
                        您还没有参与过抽奖活动。<br>
                        点击上方"抽一次"按钮开始您的幸运之旅。
                    </div>
                </div>
            </div>
        </div>

        <!-- 指南页面 -->
        <div class="container page-container" id="page-guide">
            <div class="welcome-banner">
                <h1 class="welcome-title">OKX Boost活动指南</h1>
                <p class="welcome-subtitle">
                    了解OKX Boost活动规则、操作流程和奖励机制，最大化您的链上收益。
                </p>
            </div>

            <!-- 活动介绍 -->
            <section class="guide-section">
                <h3 class="section-title"><i class="fas fa-info-circle"></i> 活动介绍</h3>
                
                <div class="info-card">
                    <div class="info-card-title">🚀 OKX Boost活动介绍</div>
                    <div class="info-card-content">
                        <p>通过OKX Wallet的【兑换】交易 H 代币，这是社区活跃数据的展示，同时也能获得欧易官方每期的新币空投奖励。</p>
                        <p>Boost数据每十天更新一天，在活动开始后的交易量不计入（也就是说，要先有交易量才能参与空投奖励)</p>
                        <p><strong>查看Boost数据路径：</strong>打开OKX Wallet → 菜单栏 [Boost] →查看详情</p>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-title">✨ 一句话了解活动</div>
                    <div class="info-card-content">
                        通过参与活动，您不仅能为社区创造关键数据，更能稳定获取OKX官方新币空投奖励。
                    </div>
                </div>
            </section>

            <!-- 操作流程 -->
            <section class="guide-section">
                <h3 class="section-title"><i class="fas fa-list-ol"></i> 操作流程</h3>
                
                <div class="info-card">
                    <div class="info-card-title">📊 活动核心机制</div>
                    <div class="info-card-content">
                        <p><strong>原理：</strong>在OKX Wallet使用 H代币 进行兑换交易，积累交易量（Boost数据）。</p>
                        <p><strong>奖励：</strong>交易量将转化为积分，直接决定您瓜分每期官方新币空投的份额。</p>
                        <p><strong>节奏：</strong>Boost数据每10天更新一次。这意味着，必须提前拥有交易量记录，才能参与下一期的奖励分配。</p>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-title">📈 四步参与法</div>
                    <div class="info-card-content">
                        <ol>
                            <li><strong>第一步：质押获取弹药</strong><br>
                                在社区平台质押USDT，每日20:00 (UTC+8) 稳定领取 H 代币收益。<br>
                                （这是您"零成本"参与活动的核心本金）</li>
                            <li><strong>第二步：择时兑换，放大价值</strong><br>
                                次日，根据群内流动性提示，将领取的H代币兑换为USDT或OKB。<br>
                                （社区将协调资金入场支撑价格，旨在让您换得更多！）</li>
                            <li><strong>第三步：执行交易，积累数据</strong><br>
                                使用兑换到  资金，完成每日 2-5次 的兑换交易。<br>
                                <em>关键技巧：可使用 "限价单" ，设置与市场价接近的报价，以几乎零成本的方式完成交易量（后期有教程）</em></li>
                            <li><strong>第四步：循环滚动，飞轮增长</strong><br>
                                每日重复此过程。您的交易量将持续积累，奖励随之增长，形成 "收益越多 → 交易量越大 → 奖励更多" 的飞轮效应。</li>
                        </ol>
                    </div>
                </div>
            </section>

            <!-- 规则与奖励 -->
            <section class="guide-section">
                <h3 class="section-title"><i class="fas fa-award"></i> 规则与奖励</h3>
                
                <div class="info-card">
                    <div class="info-card-title">【一】规则说明</div>
                    <div class="info-card-content">
                        <ol>
                            <li>参与Boost交易的 H 代币必须来自质押的收益（如果是购买，转账等其他方式来源，则取消各种权益）</li>
                            <li>根据群通知策略进行【兑换】交易，如频繁交易产生的磨损自行承担，且取消社区奖励</li>
                            <li>所有参与交易的地址均要填写表单提交报备</li>
                            <li>如磨损不明，则按照质押本金产生的USDT价值来评判与实际代币的价值是否符合</li>
                            <li>H 代币可以随时【兑换】USDT不参与Boost，也可以自己购买自己独立参与，自己承担磨损费用。</li>
                        </ol>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-title">【二】奖励介绍</div>
                    <div class="info-card-content">
                        <ol>
                            <li><strong>累计邀请3位新人参与质押总额达2000U</strong><br>
                                奖励：价值188U的H币 | 500U瓜分额度</li>
                            <li><strong>累计邀请5位新人参与质押总额达5000U</strong><br>
                                奖励：价值388U的H币 | 1000U瓜分额度</li>
                            <li><strong>累计邀请10位新人参与质押总额达10000U</strong><br>
                                奖励：价值888U的H币 | 3000U瓜分额度</li>
                            <li><strong>达到了邀请奖励条件的被邀请人奖励价值58U的H币</strong></li>
                        </ol>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-title">H代币回购与价格支撑执行细则</div>
                    <div class="info-card-content">
                        <p><strong>一、核心目标</strong><br>
                        在Boost活动期间，通过策略性市场买入，稳定并适度提升H代币价格，确保社区成员在将H兑换为USDT/OKB时, 能获得有竞争力的价格，从而覆盖大部分甚至全部交易磨损。</p>
                        
                        <p><strong>二、回购销毁与执行策略</strong></p>
                        <ol>
                            <li>每日社区发布"Boost时间"前后30分钟，社区会注入流动性引导价格温和上涨</li>
                            <li>在市场出现恐慌性抛售，社区会吸收卖压稳定价格</li>
                            <li>每达到一个阶段，社区会进行销毁（具体方案待公测结束后会根据实践数据制定）</li>
                        </ol>
                    </div>
                </div>
            </section>

            <!-- 社区策略与保障 -->
            <section class="guide-section">
                <h3 class="section-title"><i class="fas fa-shield-alt"></i> 社区策略与保障</h3>
                
                <div class="info-card">
                    <div class="info-card-title">🛡 社区协同策略：更高收益，更低风险</div>
                    <div class="info-card-content">
                        <p>为最大化您的收益并控制风险，社区提供独家支持策略：</p>
                        <ol>
                            <li><strong>【质押USDT】</strong>每日20点可领取 H  代币收益</li>
                            <li><strong>第二天根据群里提示有流动性进入通知</strong>，将 H 【兑换】成 USDT或OKB （每日交易2-5次）即可</li>
                            <li><strong>每日领取H 积少成多</strong>，交易量越大，奖励越多，奖励越多，促进越大的交易量，从而形成一个正向分飞轮增长效应</li>
                            <li><strong>Boost活动基本上每周都有</strong>，保持交易量不仅为社区创造流动性，同时还能获得欧易官方奖励</li>
                            <li><strong>社区用户参与活动期间如产生的滑点损耗大于实际所得价值，由社区承担该部分损耗</strong>（具体方案奖励根据首批参与者公测后的数据在定）</li>
                        </ol>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-card-title">🎯 社区支持与保障</div>
                    <div class="info-card-content">
                        <p><strong>风险缓冲：</strong>活动期间，若因遵循社区策略产生的合理滑点损耗大于所获奖励价值，社区将评估后进行补偿。（具体细则将根据首批公测数据最终确定并公示）</p>
                        <p><strong>长期红利：</strong>Boost活动高频开放。持续参与，即为社区创造长期流动性，同时为自己积累持续的官方空投收益。</p>
                        <p><strong>📢 行动呼吁：</strong>立即完成质押，锁定明日H收益，等待我们的流动性提示！</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- 常见问题页面 -->
        <div class="container page-container" id="page-faq">
            <div class="welcome-banner">
                <h1 class="welcome-title">常见问题解答</h1>
                <p class="welcome-subtitle">
                    解答您在海豚社区参与OKX Boost活动中可能遇到的问题与疑惑。
                </p>
            </div>

            <!-- 快捷访问 -->
            <section class="guide-section">
                <h3 class="section-title"><i class="fas fa-external-link-alt"></i> 快捷访问</h3>
                
                <div class="info-card">
                    <div class="info-card-title">✅ 便捷访问入口（点击即可进入）</div>
                    <div class="info-card-content">
                        <div class="link-grid">
                            <div class="link-card" onclick="window.open('https://hstaking.space', '_blank')">
                                <div class="link-icon">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <div class="link-text">链上赚币|质押</div>
                            </div>
                            
                            <div class="link-card" onclick="window.open('https://web3.okx.com/ul/3yFdiPq', '_blank')">
                                <div class="link-icon">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                <div class="link-text">购买 H 代币</div>
                            </div>
                            
                            <div class="link-card" onclick="window.open('https://oyidl.me/ul/S1ycxF8', '_blank')">
                                <div class="link-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="link-text">海豚社区红包群</div>
                            </div>
                            
                            <div class="link-card" onclick="window.open('http://sfw.vc/DPH_OKX', '_blank')">
                                <div class="link-icon">
                                    <i class="fas fa-bullhorn"></i>
                                </div>
                                <div class="link-text">OKX Boost频道</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 常见问题 -->
            <section class="guide-section">
                <h3 class="section-title"><i class="fas fa-question-circle"></i> 常见问题</h3>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>1. 什么是OKX Boost活动？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        OKX Boost是欧易官方推出的链上活动，用户通过在OKX Wallet进行兑换交易，积累交易量数据，从而获得官方新币空投奖励。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>2. 如何查看我的Boost数据？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        打开OKX Wallet → 底部菜单栏点击【Boost】 → 查看您的实时交易量详情与排名。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>3. 为什么需要先质押USDT？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        质押USDT可以每日获得H代币收益，这些H代币是您参与Boost活动的"零成本"弹药，避免了直接购买代币的市场风险。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>4. 参与Boost活动有什么风险？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        主要风险是交易时的滑点损耗。但海豚社区提供风险缓冲机制：若因遵循社区策略产生的合理滑点损耗大于所获奖励价值，社区将评估后进行补偿。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>5. 我可以自己购买H代币参与吗？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        可以，但自行购买的H代币参与Boost活动将无法获得社区奖励和保障。只有通过社区质押获得的H代币才能享受完整的社区支持。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>6. 如何获得邀请奖励？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        邀请新人参与质押，当累计邀请人数和质押总额达到特定条件时，即可获得相应奖励。具体奖励标准请查看"规则与奖励"部分。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>7. 社区如何支撑H代币价格？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        社区会在每日"Boost时间"前后30分钟注入流动性引导价格温和上涨，并在市场出现恐慌性抛售时吸收卖压稳定价格。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>8. 质押的USDT可以随时提取吗？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        质押USDT有相应的质押期限，具体取决于您选择的质押方案。请在质押前仔细阅读相关条款。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>9. 如何减少交易磨损？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        可以使用"限价单"，设置与市场价接近的报价，以几乎零成本的方式完成交易量。社区后期会提供详细教程。
                    </div>
                </div>
                
                <div class="faq-item" onclick="toggleFAQ(this)">
                    <div class="faq-question">
                        <span>10. 活动奖励多久发放一次？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        OKX官方的新币空投奖励通常根据Boost数据每10天更新一次进行分配。社区奖励会根据活动表现定期发放。
                    </div>
                </div>
            </section>
            
            <!-- 温馨提示 -->
            <div class="info-card mt-3">
                <div class="info-card-title">💡 温馨提示</div>
                <div class="info-card-content">
                    <p>🎁 随着OKX Web3生态的蓬勃发展，Boost将会有越来越多的赚币活动奖励，同时社区也会带领大家解锁更多赚币场景😊</p>
                    <p>如有更多问题，请通过社区群聊或反馈表单联系我们。</p>
                </div>
            </div>
        </div>
    </main>

    <!-- 底部导航 -->
    <nav class="bottom-nav">
        <div class="nav-items">
            <div class="nav-item active" onclick="showPage('home')">
                <i class="fas fa-home nav-icon"></i>
                <span class="nav-label">首页</span>
            </div>
            <div class="nav-item" onclick="showPage('calculator')">
                <i class="fas fa-calculator nav-icon"></i>
                <span class="nav-label">计算器</span>
            </div>
            <div class="nav-item" onclick="showPage('ledger')">
                <i class="fas fa-book nav-icon"></i>
                <span class="nav-label">账本</span>
            </div>
            <div class="nav-item" onclick="showPage('checkin')">
                <i class="fas fa-calendar-check nav-icon"></i>
                <span class="nav-label">签到</span>
            </div>
            <div class="nav-item" onclick="showPage('lottery')">
                <i class="fas fa-gift nav-icon"></i>
                <span class="nav-label">抽奖</span>
            </div>
            <div class="nav-item" onclick="showPage('guide')">
                <i class="fas fa-book-open nav-icon"></i>
                <span class="nav-label">指南</span>
            </div>
        </div>
    </nav>

    <!-- 添加记录模态框 -->
    <div class="modal" id="addRecordModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">添加收益记录</div>
                <div class="modal-close" onclick="closeModal('addRecordModal')">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            
            <form id="recordForm" onsubmit="addRecord(event)">
                <div class="form-group">
                    <label class="form-label">记录日期</label>
                    <input type="date" class="form-input" id="recordDate" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">质押USDT金额</label>
                    <input type="number" class="form-input" id="recordUSDT" placeholder="输入USDT数量" min="1" step="0.01" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">获得H代币数量</label>
                    <input type="number" class="form-input" id="recordH" placeholder="输入H代币数量" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Boost奖励 (USDT或H)</label>
                    <input type="number" class="form-input" id="recordBoostReward" placeholder="输入Boost奖励" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label class="form-label">社区奖励 (USDT或H)</label>
                    <input type="number" class="form-input" id="recordCommunityReward" placeholder="输入社区奖励" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label class="form-label">备注说明</label>
                    <input type="text" class="form-input" id="recordNote" placeholder="可选备注">
                </div>
                
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-save"></i> 保存记录
                </button>
            </form>
        </div>
    </div>

    <!-- 抽奖结果模态框 -->
    <div class="modal" id="prizeModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">抽奖结果</div>
                <div class="modal-close" onclick="closeModal('prizeModal')">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            
            <div style="text-align: center; padding: var(--space-xl) 0;" id="prizeResult">
                <!-- 抽奖结果内容通过JS动态生成 -->
            </div>
            
            <div style="text-align: center;">
                <button class="btn btn-secondary" onclick="closeModal('prizeModal')">
                    继续抽奖
                </button>
            </div>
        </div>
    </div>

    <!-- 多次抽奖结果模态框 -->
    <div class="modal" id="multiPrizeModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">批量抽奖结果</div>
                <div class="modal-close" onclick="closeModal('multiPrizeModal')">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            
            <div style="max-height: 300px; overflow-y: auto; margin: var(--space-lg) 0;">
                <table style="width: 100%; border-collapse: collapse;" id="multiPrizeTable">
                    <thead>
                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <th style="padding: var(--space-sm) 0; text-align: left;">次数</th>
                            <th style="padding: var(--space-sm) 0; text-align: left;">奖品</th>
                            <th style="padding: var(--space-sm) 0; text-align: right;">H代币</th>
                        </tr>
                    </thead>
                    <tbody id="multiPrizeBody">
                        <!-- 多次抽奖结果将通过JS动态生成 -->
                    </tbody>
                </table>
            </div>
            
            <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: var(--space-md);">
                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-sm);">
                    <span>总消耗HT</span>
                    <span style="color: var(--accent-teal); font-weight: 700;" id="totalCostHT">0</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-sm);">
                    <span>获得H代币</span>
                    <span style="color: var(--accent-teal); font-weight: 700;" id="totalWonHModal">0</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-lg);">
                    <span>净收益</span>
                    <span style="color: var(--success); font-weight: 700;" id="netProfit">0 H</span>
                </div>
            </div>
            
            <button class="btn btn-secondary btn-block" onclick="closeModal('multiPrizeModal')">
                关闭
            </button>
        </div>
    </div>

    <!-- 反馈模态框 -->
    <div class="modal" id="feedbackModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">反馈与建议</div>
                <div class="modal-close" onclick="closeModal('feedbackModal')">
                    <i class="fas fa-times"></i>
                </div>
            </div>
            
            <div style="text-align: center; padding: var(--space-xl) 0;">
                <div style="width: 80px; height: 80px; background: var(--gradient-full); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-lg); font-size: 2rem; color: var(--primary-dark);">
                    <i class="fas fa-comments"></i>
                </div>
                <h3 style="margin-bottom: var(--space-sm);">我们重视您的意见</h3>
                <p style="color: var(--text-secondary); margin-bottom: var(--space-xl); line-height: 1.5;">
                    如果您对海豚社区有任何建议、问题或反馈，请通过以下表单联系我们。
                    您的意见将帮助我们不断改进服务。
                </p>
                
                <button class="btn btn-primary btn-block" onclick="window.open('https://f.wps.cn/ksform/w/write/5rJjd9vy/', '_blank')">
                    <i class="fas fa-paper-plane"></i> 前往反馈表单
                </button>
                
                <button class="btn btn-secondary btn-block mt-2" onclick="closeModal('feedbackModal')">
                    稍后再说
                </button>
            </div>
        </div>
    </div>

    <!-- 初始化加载动画 -->
    <div class="modal" id="loadingModal" style="display: flex; background: rgba(10, 17, 40, 0.95);">
        <div class="modal-content" style="max-width: 300px; text-align: center;">
            <div style="width: 60px; height: 60px; background: var(--gradient-full); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-lg); font-size: 1.8rem; color: var(--primary-dark); animation: pulse 2s infinite;">
                <i class="fas fa-dolphin"></i>
            </div>
            <h3 style="margin-bottom: var(--space-sm);">海豚社区</h3>
            <p style="color: var(--text-secondary);">正在加载您的数据...</p>
        </div>
    </div>

    <script>
        // ===== 数据存储键名 =====
        const STORAGE_KEYS = {
            USER_ID: 'dolphin_user_id_v2',
            USER_DATA: 'dolphin_user_data_v2',
            LEDGER_RECORDS: 'dolphin_ledger_records_v2',
            CHECKIN_DATA: 'dolphin_checkin_data_v2',
            LOTTERY_DATA: 'dolphin_lottery_data_v2'
        };

        // ===== 全局数据模型 =====
        let appData = {
            user: {
                id: null,
                created: null
            },
            checkin: {
                lastCheckin: null,
                streak: 0,
                totalStreak: 0,
                monthlyCheckins: {},
                totalHT: 0,
                totalCheckins: 0,
                extraRewardsGiven: []
            },
            lottery: {
                totalSpins: 0,
                totalSpentHT: 0,
                totalWonH: 0,
                prizesWon: [],
                todaySpins: 0,
                lastSpinDate: null
            },
            ledger: []
        };

        // ===== 质押阶梯收益规则 =====
        const STAKING_RULES = [
            { min: 1, max: 7, rate: 0.005, name: "第一阶段", color: "#FF6B6B" },
            { min: 8, max: 15, rate: 0.006, name: "第二阶段", color: "#4ECDC4" },
            { min: 16, max: 30, rate: 0.008, name: "第三阶段", color: "#45B7D1" },
            { min: 31, max: 60, rate: 0.01, name: "第四阶段", color: "#96CEB4" },
            { min: 61, max: Infinity, rate: 0.012, name: "第五阶段", color: "#FFEAA7" }
        ];

        // ===== 抽奖项配置 =====
        const PRIZES = [
            { id: 1, name: "很遗憾，再接再厉", hToken: 0, probability: 0.97, color: "#FF6B6B" },
            { id: 2, name: "获得3000H代币", hToken: 3000, probability: 0.0075, color: "#4ECDC4" },
            { id: 3, name: "获得5000H代币", hToken: 5000, probability: 0.0075, color: "#45B7D1" },
            { id: 4, name: "获得10000H代币", hToken: 10000, probability: 0.0075, color: "#96CEB4" },
            { id: 5, name: "获得10000H代币", hToken: 10000, probability: 0.0075, color: "#FFEAA7" },
            { id: 6, name: "获得欧易VIP体验卡一张", hToken: 0, probability: 0, color: "#DDA0DD" },
            { id: 7, name: "获得DPH空投奖励", hToken: 0, probability: 0, color: "#FFA07A" }
        ];

        // ===== 图表实例 =====
        let rewardChart = null;
        let ledgerChart = null;

        // ===== 页面加载初始化 =====
        document.addEventListener('DOMContentLoaded', function() {
            // 显示加载动画
            showLoading(true);
            
            // 延迟初始化以确保DOM完全加载
            setTimeout(() => {
                initApp();
                showLoading(false);
            }, 800);
            
            // 设置默认日期
            const today = new Date().toISOString().split('T')[0];
            const recordDateElem = document.getElementById('recordDate');
            if (recordDateElem) recordDateElem.value = today;
            
            // 设置当前月份显示
            const monthNames = ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'];
            const now = new Date();
            const currentMonthElem = document.getElementById('currentMonth');
            if (currentMonthElem) currentMonthElem.textContent = `${now.getFullYear()}年${monthNames[now.getMonth()]}`;
            
            // 初始化FAQ点击事件
            initFAQ();
        });

        // ===== 应用初始化 =====
        function initApp() {
            // 加载所有数据
            loadAllData();
            
            // 生成用户ID（如果不存在）
            generateUserId();
            
            // 初始化UI
            updateAllUI();
            
            // 设置默认页面
            showPage('home');
            
            // 设置滚动监听
            setupScrollListener();
            
            // 生成抽奖转盘
            generateWheel();
            
            // 生成奖品展示
            generatePrizesGrid();
            
            // 初始化图表
            initCharts();
            
            // 检查是否需要重置今日抽奖次数
            checkDailyReset();
        }

        // ===== FAQ功能 =====
        function initFAQ() {
            // FAQ点击事件已经在HTML中通过onclick绑定
        }
        
        function toggleFAQ(faqItem) {
            if (!faqItem) return;
            faqItem.classList.toggle('active');
        }

        // ===== 数据加载与保存 =====
        function loadAllData() {
            try {
                // 加载用户数据
                const savedUserData = localStorage.getItem(STORAGE_KEYS.USER_DATA);
                if (savedUserData) {
                    const parsed = JSON.parse(savedUserData);
                    appData.user = parsed.user || appData.user;
                    appData.checkin = parsed.checkin || appData.checkin;
                    appData.lottery = parsed.lottery || appData.lottery;
                    appData.ledger = parsed.ledger || appData.ledger;
                }
                
                // 加载独立存储的数据（兼容旧版本）
                loadLegacyData();
            } catch (error) {
                console.error('加载数据失败:', error);
                showError('数据加载失败，已恢复默认设置');
            }
        }

        function saveAllData() {
            try {
                localStorage.setItem(STORAGE_KEYS.USER_DATA, JSON.stringify(appData));
            } catch (error) {
                console.error('保存数据失败:', error);
                showError('数据保存失败，请检查存储空间');
            }
        }

        function loadLegacyData() {
            // 兼容旧版本数据加载
            const legacyKeys = [
                'dolphin_user_id',
                'dolphin_checkin_data',
                'dolphin_lottery_data',
                'dolphin_ledger_records'
            ];
            
            legacyKeys.forEach(key => {
                const data = localStorage.getItem(key);
                if (data) {
                    try {
                        const parsed = JSON.parse(data);
                        // 根据键名合并到对应位置
                        if (key.includes('checkin')) {
                            Object.assign(appData.checkin, parsed);
                        } else if (key.includes('lottery')) {
                            Object.assign(appData.lottery, parsed);
                        } else if (key.includes('ledger')) {
                            appData.ledger = Array.isArray(parsed) ? parsed : appData.ledger;
                        } else if (key.includes('user_id')) {
                            appData.user.id = parsed;
                        }
                        
                        // 清理旧数据
                        localStorage.removeItem(key);
                    } catch (e) {
                        console.warn(`无法解析旧数据 ${key}:`, e);
                    }
                }
            });
        }

        // ===== 用户ID生成 =====
        function generateUserId() {
            if (!appData.user.id) {
                // 生成格式：H + 时间戳后6位 +   机数3位
                const timestamp = Date.now().toString().slice(-6);
                const random = Math.floor(Math.random() * 900) + 100; // 100-999
                appData.user.id = 'H' + timestamp + random;
                appData.user.created = new Date().toISOString();
                saveAllData();
            }
        }

        // ===== 每日重置检查 =====
        function checkDailyReset() {
            const today = new Date().toDateString();
            if (appData.lottery.lastSpinDate !== today) {
                appData.lottery.todaySpins = 0;
                saveAllData();
            }
        }

        // ===== UI更新 =====
        function updateAllUI() {
            // 更新顶部导航
            const navUserId = document.getElementById('navUserId');
            if (navUserId) navUserId.textContent = appData.user.id;
            const navHTBalance = document.getElementById('navHTBalance');
            if (navHTBalance) navHTBalance.textContent = appData.checkin.totalHT.toLocaleString();
            
            // 更新首页统计数据
            updateHomeStats();
            
            // 更新账本页面
            updateLedgerUI();
            
            // 更新签到页面
            updateCheckinUI();
            
            // 更新抽奖页面
            updateLotteryUI();
        }

        function updateHomeStats() {
            // 计算总质押USDT
            const totalStaked = appData.ledger.reduce((sum, record) => sum + (record.usdt || 0), 0);
            
            // 计算总获得H代币
            const totalHEarned = appData.ledger.reduce((sum, record) => sum + (record.h || 0), 0);
            
            const elHomeTotalHT = document.getElementById('homeTotalHT');
            if (elHomeTotalHT) elHomeTotalHT.textContent = appData.checkin.totalHT.toLocaleString();
            const elHomeTotalUSDT = document.getElementById('homeTotalUSDT');
            if (elHomeTotalUSDT) elHomeTotalUSDT.textContent = totalStaked.toLocaleString();
            const elHomeTotalHEarned = document.getElementById('homeTotalHEarned');
            if (elHomeTotalHEarned) elHomeTotalHEarned.textContent = totalHEarned.toLocaleString();
            const elHomeStreakDays = document.getElementById('homeStreakDays');
            if (elHomeStreakDays) elHomeStreakDays.textContent = appData.checkin.streak;
        }

        function updateLedgerUI() {
            // 更新统计数据
            const totalStaked = appData.ledger.reduce((sum, record) => sum + (record.usdt || 0), 0);
            const totalHEarned = appData.ledger.reduce((sum, record) => sum + (record.h || 0), 0);
            const totalBoostReward = appData.ledger.reduce((sum, record) => sum + (record.boostReward || 0), 0);
            const totalCommunityReward = appData.ledger.reduce((sum, record) => sum + (record.communityReward || 0), 0);
            
            const elTotalStaked = document.getElementById('totalStaked');
            if (elTotalStaked) elTotalStaked.textContent = totalStaked.toLocaleString();
            const elTotalHEarned = document.getElementById('totalHEarned');
            if (elTotalHEarned) elTotalHEarned.textContent = totalHEarned.toLocaleString();
            const elTotalBoostReward = document.getElementById('totalBoostReward');
            if (elTotalBoostReward) elTotalBoostReward.textContent = totalBoostReward.toLocaleString();
            const elTotalCommunityReward = document.getElementById('totalCommunityReward');
            if (elTotalCommunityReward) elTotalCommunityReward.textContent = totalCommunityReward.toLocaleString();
            
            // 渲染表格
            renderLedgerTable();
            
            // 更新图表
            updateLedgerChart();
        }

        function updateCheckinUI() {
            const today = new Date().toDateString();
            const isCheckedToday = appData.checkin.lastCheckin === today;
            
            // 更新状态
            const checkinStatusEl = document.getElementById('checkinStatus');
            if (checkinStatusEl) checkinStatusEl.textContent = isCheckedToday ? '今日已签到' : '等待签到';
            const checkinStreakEl = document.getElementById('checkinStreak');
            if (checkinStreakEl) checkinStreakEl.textContent = appData.checkin.streak + ' 天';
            
            // 更新按钮状态
            const checkinBtn = document.getElementById('checkinBtn');
            if (checkinBtn) {
                if (isCheckedToday) {
                    checkinBtn.innerHTML = '<i class="fas fa-check"></i> 今日已签到';
                    checkinBtn.disabled = true;
                    checkinBtn.classList.remove('btn-primary');
                    checkinBtn.classList.add('btn-secondary');
                } else {
                    checkinBtn.innerHTML = '<i class="fas fa-check"></i> 今日签到';
                    checkinBtn.disabled = false;
                    checkinBtn.classList.remove('btn-secondary');
                    checkinBtn.classList.add('btn-primary');
                }
            }
            
            // 生成日历
            generateCalendar();
        }

        function updateLotteryUI() {
            const lotteryHTBalanceEl = document.getElementById('lotteryHTBalance');
            if (lotteryHTBalanceEl) lotteryHTBalanceEl.textContent = appData.checkin.totalHT.toLocaleString();
            const todaySpinsEl = document.getElementById('todaySpins');
            if (todaySpinsEl) todaySpinsEl.textContent = appData.lottery.todaySpins;
            
            // 更新按钮状态
            const spinBtn = document.getElementById('spinBtn');
            const spin10Btn = document.getElementById('spin10Btn');
            const canSpin = appData.checkin.totalHT >= 100;
            
            if (spinBtn) spinBtn.disabled = !canSpin;
            if (spin10Btn) spin10Btn.disabled = !canSpin || appData.checkin.totalHT < 1000;
            
            // 更新抽奖记录
            renderLotteryHistory();
        }

        // ===== 页面切换 =====
        function showPage(pageId) {
            // 隐藏所有页面
            document.querySelectorAll('.page-container').forEach(page => {
                page.classList.remove('active');
            });
            
            // 显示目标页面（安全检查）
            const target = document.getElementById('page-' + pageId);
            if (target) {
                target.classList.add('active');
            } else {
                console.warn('尝试显示不存在的页面：', pageId);
            }
            
            // 更新底部导航
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            
            // 设置当前页面的导航项为激活状态
            const pageIndex = ['home', 'calculator', 'ledger', 'checkin', 'lottery', 'guide'].indexOf(pageId);
            if (pageIndex !== -1 && navItems[pageIndex]) {
                navItems[pageIndex].classList.add('active');
            }
            
            // 特殊处理FAQ页面，使用guide导航项
            if (pageId === 'faq' && navItems[5]) {
                navItems[5].classList.add('active');
            }
            
            // 页面特定初始化
            if (pageId === 'ledger') {
                updateLedgerUI();
            } else if (pageId === 'checkin') {
                updateCheckinUI();
            } else if (pageId === 'lottery') {
                updateLotteryUI();
            }
            
            // 滚动到顶部
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ===== 滚动监听 =====
        function setupScrollListener() {
            const topNav = document.querySelector('.top-nav');
            if (!topNav) return;
            let lastScroll = 0;
            
            window.addEventListener('scroll', function() {
                const currentScroll = window.pageYOffset;
                
                // 添加滚动效果
                if (currentScroll > 50) {
                    topNav.classList.add('scrolled');
                } else {
                    topNav.classList.remove('scrolled');
                }
                
                lastScroll = currentScroll;
            });
        }

        // ===== 收益计算器功能 =====
        function calculateStakingReward() {
            const stakeAmount = parseFloat(document.getElementById('stakeAmount').value);
            const stakeDays = parseInt(document.getElementById('stakeDays').value);
            
            // 验证输入
            if (!stakeAmount || stakeAmount <= 0) {
                showError('请输入有效的质押金额');
                return;
            }
            
            if (!stakeDays || stakeDays <= 0) {
                showError('请输入有效的质押天数');
                return;
            }
            
            let remainingDays = stakeDays;
            let totalReward = 0;
            let stageDetails = [];
            
            // 计算每个阶段的收益
            STAKING_RULES.forEach(rule => {
                if (remainingDays <= 0) return;
                
                let daysInStage = 0;
                if (rule.max === Infinity) {
                    daysInStage = remainingDays;
                } else {
                    const stageLength = rule.max - rule.min + 1;
                    daysInStage = Math.min(stageLength, remainingDays);
                }
                
                if (daysInStage > 0) {
                    const stageReward = stakeAmount * rule.rate * daysInStage;
                    totalReward += stageReward;
                    
                    stageDetails.push({
                        name: rule.name,
                        days: daysInStage,
                        rate: rule.rate * 100,
                        reward: stageReward,
                        color: rule.color
                    });
                    
                    remainingDays -= daysInStage;
                }
            });
            
            // 显示计算结果
            displayStageDetails(stageDetails);
            displayTotalReward(totalReward, stakeAmount, stakeDays);
            displayRewardChart(stageDetails, totalReward);
        }

        function displayStageDetails(stageDetails) {
            const stagesList = document.getElementById('stagesList');
            if (!stagesList) return;
            stagesList.innerHTML = '';
            
            if (stageDetails.length === 0) {
                stagesList.innerHTML = '<div style="text-align: center; color: var(--text-tertiary); padding: var(--space-xl);">暂无收益数据</div>';
                return;
            }
            
            stageDetails.forEach(stage => {
                const stageElement = document.createElement('div');
                stageElement.className = 'stage-item';
                stageElement.innerHTML = `
                    <div class="stage-header">
                        <div class="stage-name">${stage.name}</div>
                        <div class="stage-rate">日利率 ${stage.rate}%</div>
                    </div>
                    <div class="stage-details">
                        <span>${stage.days} 天</span>
                        <span>${stage.reward.toFixed(2)} H</span>
                    </div>
                `;
                stagesList.appendChild(stageElement);
            });
            
            const stagesContainer = document.getElementById('stagesContainer');
            if (stagesContainer) stagesContainer.style.display = 'block';
        }

        function displayTotalReward(totalReward, stakeAmount, stakeDays) {
            const elTotalRewardValue = document.getElementById('totalRewardValue');
            if (elTotalRewardValue) elTotalRewardValue.textContent = totalReward.toFixed(2);
            
            // 计算APR
            const apr = (totalReward / stakeAmount) * (365 / stakeDays) * 100;
            const aprEl = document.getElementById('aprValue');
            if (aprEl) aprEl.textContent = apr.toFixed(2) + '%';
            
            const totalRewardContainer = document.getElementById('totalRewardContainer');
            if (totalRewardContainer) totalRewardContainer.style.display = 'block';
        }

        function displayRewardChart(stageDetails, totalReward) {
            const canvas = document.getElementById('rewardChart');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            
            // 销毁现有图表（更稳健）
            if (rewardChart && typeof rewardChart.destroy === 'function') {
                rewardChart.destroy();
            }
            
            const labels = stageDetails.map(stage => stage.name);
            const data = stageDetails.map(stage => stage.reward);
            const colors = stageDetails.map(stage => stage.color || '#00D4AA');
            
            // 添加总收益
            labels.push('总收益');
            data.push(totalReward);
            colors.push('#00D4AA');
            
            rewardChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '收益 (H代币)',
                        data: data,
                        backgroundColor: colors,
                        borderColor: colors, // 使用一致颜色，较稳健
                        borderWidth: 1,
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.raw.toFixed(2)} H`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) { return value.toFixed(0) + ' H'; }
                            },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: 'rgba(255, 255, 255, 0.7)' },
                            grid: { display: false }
                        }
                    }
                }
            });
            
            const rewardChartContainer = document.getElementById('rewardChartContainer');
            if (rewardChartContainer) rewardChartContainer.style.display = 'block';
        }

        // ===== 账本功能 =====
        function showAddRecordModal() {
            const modal = document.getElementById('addRecordModal');
            if (modal) modal.style.display = 'flex';
        }

        function addRecord(event) {
            event.preventDefault();
            
            const record = {
                id: Date.now(),
                date: document.getElementById('recordDate').value,
                usdt: parseFloat(document.getElementById('recordUSDT').value) || 0,
                h: parseFloat(document.getElementById('recordH').value) || 0,
                boostReward: parseFloat(document.getElementById('recordBoostReward').value) || 0,
                communityReward: parseFloat(document.getElementById('recordCommunityReward').value) || 0,
                note: document.getElementById('recordNote').value || ''
            };
            
            appData.ledger.push(record);
            saveAllData();
            
            // 更新UI
            updateLedgerUI();
            updateHomeStats();
            
            // 重置表单
            const form = document.getElementById('recordForm');
            if (form) form.reset();
            const recordDateElem = document.getElementById('recordDate');
            if (recordDateElem) recordDateElem.value = new Date().toISOString().split('T')[0];
            
            // 关闭模态框
            closeModal('addRecordModal');
            
            // 显示成功消息
            showSuccess('记录添加成功！');
        }

        function deleteRecord(recordId) {
            if (confirm('确定要删除这条记录吗？此操作不可撤销。')) {
                appData.ledger = appData.ledger.filter(record => record.id !== recordId);
                saveAllData();
                
                // 更新UI
                updateLedgerUI();
                updateHomeStats();
                
                showSuccess('记录已删除');
            }
        }

        function renderLedgerTable() {
            const tbody = document.getElementById('ledgerBody');
            const emptyMessage = document.getElementById('emptyLedgerMessage');
            const tableContainer = document.getElementById('ledgerTableContainer');
            
            if (!tbody || !emptyMessage || !tableContainer) return;
            
            if (appData.ledger.length === 0) {
                tbody.innerHTML = '';
                emptyMessage.style.display = 'block';
                tableContainer.style.display = 'none';
                return;
            }
            
            emptyMessage.style.display = 'none';
            tableContainer.style.display = 'block';
            
            // 按日期降序排序
            const sortedRecords = [...appData.ledger].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = '';
            sortedRecords.forEach(record => {
                const date = new Date(record.date);
                const dateStr = `${date.getMonth() + 1}/${date.getDate()}`;
                
                html += `
                    <tr>
                        <td class="record-date">${dateStr}</td>
                        <td class="record-amount">${record.usdt.toLocaleString()}</td>
                        <td>${record.h.toLocaleString()}</td>
                        <td>${record.boostReward.toLocaleString()}</td>
                        <td>${record.communityReward.toLocaleString()}</td>
                        <td class="record-action">
                            <button class="delete-btn" onclick="deleteRecord(${record.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }

        // ===== 签到功能 =====
        function generateCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            if (!calendarGrid) return;
            calendarGrid.innerHTML = '';
            
            const today = new Date();
            const currentDate = today.getDate();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            // 生成星期标题
            const weekDays = ['日', '一', '二', '三', '四', '五', '六'];
            weekDays.forEach(day => {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day day-header';
                dayDiv.textContent = day;
                calendarGrid.appendChild(dayDiv);
            });
            
            // 获取本月签到记录
            const monthKey = `${currentYear}-${currentMonth + 1}`;
            const checkinsThisMonth = appData.checkin.monthlyCheckins[monthKey] || [];
            
            // 计算当月第一天是星期几（0 = 星期日）
            const firstDayOfWeek = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // 添加空白占位，以对齐第一天
            for (let i = 0; i < firstDayOfWeek; i++) {
                const placeholder = document.createElement('div');
                placeholder.className = 'calendar-day';
                placeholder.style.visibility = 'hidden';
                calendarGrid.appendChild(placeholder);
            }
            
            // 生成本月日历
            for (let i = 1; i <= daysInMonth; i++) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                
                const isChecked = checkinsThisMonth.includes(i);
                const isToday = i === currentDate;
                
                if (isChecked) dayDiv.classList.add('day-checked');
                if (isToday && !isChecked) dayDiv.classList.add('day-today');
                
                dayDiv.textContent = i;
                calendarGrid.appendChild(dayDiv);
            }
        }

        function performCheckin() {
            const today = new Date();
            const todayStr = today.toDateString();
            
            // 检查是否已签到
            if (appData.checkin.lastCheckin === todayStr) {
                showError('今天已经签到过了！');
                return;
            }
            
            // 计算奖励
            let reward = 500;
            let message = `签到成功！获得${reward} HT币`;
            
            // 检查连续签到
            if (appData.checkin.lastCheckin) {
                const lastCheckin = new Date(appData.checkin.lastCheckin);
                const diffTime = today - lastCheckin;
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays === 1) {
                    appData.checkin.streak += 1;
                } else {
                    appData.checkin.streak = 1;
                }
            } else {
                appData.checkin.streak = 1;
            }
            
            // 检查额外奖励
            if (appData.checkin.streak === 15 && !appData.checkin.extraRewardsGiven.includes(15)) {
                reward += 3000;
                appData.checkin.extraRewardsGiven.push(15);
                message = `🎉 恭喜连续签到15天！获得额外3000HT奖励，总计${reward} HT币！`;
            }
            
            if (appData.checkin.streak === 30 && !appData.checkin.extraRewardsGiven.includes(30)) {
                reward += 5000;
                appData.checkin.extraRewardsGiven.push(30);
                message = `🎉 恭喜连续签到30天！获得额外5000HT奖励，总计${reward} HT币！`;
            }
            
            // 更新数据
            appData.checkin.lastCheckin = todayStr;
            appData.checkin.totalHT += reward;
            appData.checkin.totalCheckins += 1;
            
            // 记录本月签到
            const monthKey = `${today.getFullYear()}-${today.getMonth() + 1}`;
            if (!appData.checkin.monthlyCheckins[monthKey]) {
                appData.checkin.monthlyCheckins[monthKey] = [];
            }
            appData.checkin.monthlyCheckins[monthKey].push(today.getDate());
            
            // 保存数据
            saveAllData();
            
            // 更新UI
            updateCheckinUI();
            updateAllUI();
            
            // 显示成功消息
            showSuccess(message);
        }

        // ===== 抽奖功能 =====
        function generateWheel() {
            const wheel = document.getElementById('wheel');
            if (!wheel) return;
            wheel.innerHTML = '';
            
            const segmentAngle = 360 / PRIZES.length;
            
            PRIZES.forEach((prize, index) => {
                const segment = document.createElement('div');
                segment.className = 'wheel-segment';
                segment.style.backgroundColor = prize.color;
                segment.style.transform = `rotate(${index * segmentAngle}deg) skewY(${90 - segmentAngle}deg)`;
                
                const prizeText = document.createElement('div');
                prizeText.style.transform = `skewY(${segmentAngle - 90}deg) rotate(${segmentAngle/2}deg)`;
                prizeText.style.textAlign = 'center';
                prizeText.style.width = '100%';
                prizeText.style.paddingLeft = '20px';
                prizeText.style.fontSize = '0.8rem';
                prizeText.innerHTML = `<div>${prize.name.split('，')[0]}</div>`;
                
                segment.appendChild(prizeText);
                wheel.appendChild(segment);
            });
        }

        function generatePrizesGrid() {
            const prizesGrid = document.getElementById('prizesGrid');
            if (!prizesGrid) return;
            prizesGrid.innerHTML = '';
            
            PRIZES.forEach(prize => {
                if (prize.id <= 5) { // 只显示前5个奖品
                    const prizeCard = document.createElement('div');
                    prizeCard.className = 'prize-card';
                    
                    let probabilityText = '';
                    if (prize.id === 1) {
                        probabilityText = '97%';
                    } else {
                        probabilityText = '0.75%';
                    }
                    
                    prizeCard.innerHTML = `
                        <div class="prize-name">${prize.name}</div>
                        <div class="prize-value">${prize.hToken > 0 ? prize.hToken.toLocaleString() + ' H' : '无'}</div>
                        <div class="prize-probability">概率: ${probabilityText}</div>
                    `;
                    
                    prizesGrid.appendChild(prizeCard);
                }
            });
        }

        function spinWheel(count = 1) {
            // 检查HT币余额
            const cost = count * 100;
            if (appData.checkin.totalHT < cost) {
                showError(`HT币不足！需要${cost}HT，当前只有${appData.checkin.totalHT}HT`);
                return;
            }
            
            // 批量抽奖逻辑
            if (count > 1) {
                performMultiSpin(count, cost);
                return;
            }
            
            // 单次抽奖逻辑
            const spinBtn = document.getElementById('spinBtn');
            if (spinBtn) {
                spinBtn.disabled = true;
                spinBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 抽奖中...';
            }
            
            // 获取随机奖品
            const prize = getRandomPrize();
            
            // 执行抽奖
            performSpin(prize, spinBtn);
        }

        function getRandomPrize() {
            const random = Math.random();
            let cumulative = 0;
            
            for (const prize of PRIZES) {
                cumulative += prize.probability;
                if (random <= cumulative) {
                    return prize;
                }
            }
            
            return PRIZES[0];
        }

        // ===== 修正后的 performSpin：确保中奖 H 计入余额，兼容缺失元素 =====
        function performSpin(prize, spinBtn) {
            // 扣除HT币
            appData.checkin.totalHT -= 100;
            
            // 记录中奖
            appData.lottery.totalSpins++;
            appData.lottery.prizesWon.push({
                prizeId: prize.id,
                name: prize.name,
                hToken: prize.hToken,
                date: new Date().toISOString()
            });
            
            appData.lottery.totalSpentHT += 100;
            appData.lottery.totalWonH += prize.hToken || 0;
            appData.lottery.todaySpins++;
            appData.lottery.lastSpinDate = new Date().toDateString();
            
            // 如果奖品有 H 代币，加入用户余额（之前缺失导致余额不变）
            if (prize.hToken && prize.hToken > 0) {
                appData.checkin.totalHT += prize.hToken;
            }
            
            // 旋转转盘动画
            const wheel = document.getElementById('wheel');
            const spins = 5 + Math.random() * 2; // 5-7圈
            const segmentAngle = 360 / PRIZES.length;
            const targetAngle = spins * 360 + (prize.id - 1) * segmentAngle + Math.random() * segmentAngle;
            
            if (wheel) {
                wheel.style.transition = 'transform 3s cubic-bezier(0.2, 0.8, 0.3, 1)';
                wheel.style.transform = `rotate(${targetAngle}deg)`;
            }
            
            // 显示结  并恢复按钮、保存数据
            setTimeout(() => {
                showPrizeResult(prize);
                if (spinBtn) {
                    spinBtn.disabled = false;
                    spinBtn.innerHTML = '<i class="fas fa-play"></i> 抽一次';
                }
                
                // 保存数据并更新UI
                saveAllData();
                updateAllUI();
            }, 3200);
        }

        // ===== 修正后的批量抽奖：把总中奖 H 加入余额并记录每次结果 =====
        function performMultiSpin(count, cost) {
            const results = [];
            let totalH = 0;
            
            for (let i = 0; i < count; i++) {
                const prize = getRandomPrize();
                results.push(prize);
                totalH += prize.hToken || 0;
                
                // 同时记录每次中奖记录
                appData.lottery.prizesWon.push({
                    prizeId: prize.id,
                    name: prize.name,
                    hToken: prize.hToken,
                    date: new Date().toISOString()
                });
                
                appData.lottery.totalSpins++;
            }
            
            // 扣除HT币
            appData.checkin.totalHT -= cost;
            
            // 将获得的 H 计入用户余额
            if (totalH > 0) {
                appData.checkin.totalHT += totalH;
            }
            
            appData.lottery.totalSpentHT += cost;
            appData.lottery.totalWonH += totalH;
            appData.lottery.todaySpins += count;
            appData.lottery.lastSpinDate = new Date().toDateString();
            
            // 保存数据
            saveAllData();
            updateAllUI();
            
            // 显示批量抽奖结果
            showMultiPrizeResults(results, cost, totalH);
        }

        function showPrizeResult(prize) {
            const prizeResult = document.getElementById('prizeResult');
            if (!prizeResult) return;
            
            if (prize.id === 1) {
                prizeResult.innerHTML = `
                    <div style="width: 80px; height: 80px; background: #FF6B6B; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-lg); font-size: 2rem;">
                        <i class="fas fa-frown"></i>
                    </div>
                    <h3 style="margin-bottom: var(--space-sm);">${prize.name}</h3>
                    <p style="color: var(--text-secondary);">
                        不要灰心，下次一定中奖！
                    </p>
                `;
            } else {
                prizeResult.innerHTML = `
                    <div style="width: 100px; height: 100px; background: var(--gradient-full); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--space-lg); font-size: 3rem;">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h3 style="margin-bottom: var(--space-sm);">🎉 恭喜中奖! 🎉</h3>
                    <p style="color: var(--text-secondary); margin-bottom: var(--space-sm);">
                        您获得了: <span style="color: var(--accent-teal); font-weight: 700; font-size: 1.2rem;">${prize.name}</span>
                    </p>
                    <p style="color: var(--text-secondary); margin-bottom: var(--space-lg);">
                        奖励: <span style="color: var(--accent-teal); font-weight: 700; font-size: 1.2rem;">${prize.hToken.toLocaleString()} H代币</span>
                    </p>
                    <p style="font-size: 0.9rem; color: var(--text-secondary);">
                        奖励已添加到您的账户
                    </p>
                `;
            }
            
            showModal('prizeModal');
        }

        function showMultiPrizeResults(results, cost, totalH) {
            const multiPrizeBody = document.getElementById('multiPrizeBody');
            if (!multiPrizeBody) return;
            multiPrizeBody.innerHTML = '';
            
            let winCount = 0;
            
            results.forEach((prize, index) => {
                const row = document.createElement('tr');
                row.style.borderBottom = '1px solid rgba(255,255,255,0.05)';
                
                const isWin = prize.id > 1;
                if (isWin) winCount++;
                
                row.innerHTML = `
                    <td style="padding: var(--space-sm) 0;">${index + 1}</td>
                    <td style="padding: var(--space-sm) 0; color: ${isWin ? 'var(--accent-teal)' : 'var(--text-secondary)'}">${prize.name}</td>
                    <td style="padding: var(--space-sm) 0; text-align: right; color: ${isWin ? 'var(--accent-teal)' : 'var(--text-secondary)'}">${prize.hToken > 0 ? prize.hToken.toLocaleString() + ' H' : '-'}</td>
                `;
                
                multiPrizeBody.appendChild(row);
            });
            
            const totalCostEl = document.getElementById('totalCostHT');
            if (totalCostEl) totalCostEl.textContent = cost.toLocaleString() + ' HT';
            const totalWonEl = document.getElementById('totalWonHModal');
            if (totalWonEl) totalWonEl.textContent = totalH.toLocaleString() + ' H';
            
            const netProfit = totalH - cost;
            const netProfitElement = document.getElementById('netProfit');
            if (netProfitElement) {
                netProfitElement.textContent = netProfit.toLocaleString() + ' H';
                netProfitElement.style.color = netProfit >= 0 ? 'var(--success)' : 'var(--danger)';
            }
            
            showModal('multiPrizeModal');
            
            // 显示庆祝消息
            if (winCount > 0) {
                setTimeout(() => {
                    showSuccess(`批量抽奖完成！共抽奖${results.length}次，中奖${winCount}次，获得${totalH.toLocaleString()} H代币！`);
                }, 500);
            }
        }

        function renderLotteryHistory() {
            const tbody = document.getElementById('lotteryHistoryBody');
            const emptyMessage = document.getElementById('emptyLotteryHistory');
            if (!tbody || !emptyMessage) return;
            
            if (!appData.lottery.prizesWon || appData.lottery.prizesWon.length === 0) {
                tbody.innerHTML = '';
                emptyMessage.style.display = 'block';
                return;
            }
            
            emptyMessage.style.display = 'none';
            
            // 获取最近10条记录
            const recentPrizes = appData.lottery.prizesWon.slice(-10).reverse();
            
            let html = '';
            recentPrizes.forEach((prize, index) => {
                const date = new Date(prize.date);
                const timeStr = `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
                const isWin = prize.prizeId > 1;
                
                html += `
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <td style="padding: var(--space-sm) 0; font-size: 0.85rem; color: var(--text-tertiary);">${timeStr}</td>
                        <td style="padding: var(--space-sm) 0; color: ${isWin ? 'var(--accent-teal)' : 'var(--text-secondary)'}">${prize.name}</td>
                        <td style="padding: var(--space-sm) 0; text-align: right; color: ${isWin ? 'var(--accent-teal)' : 'var(--text-secondary)'}">${prize.hToken > 0 ? prize.hToken.toLocaleString() + ' H' : '-'}</td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }

        // ===== 图表功能 =====
        function initCharts() {
            // 初始化收益图表（如果 canvas 存在）
            const rewardCanvas = document.getElementById('rewardChart');
            if (rewardCanvas) {
                try {
                    const rewardCtx = rewardCanvas.getContext('2d');
                    if (rewardChart && typeof rewardChart.destroy === 'function') rewardChart.destroy();
                    rewardChart = new Chart(rewardCtx, {
                        type: 'bar',
                        data: {
                            labels: [],
                            datasets: [{
                                label: '收益 (H代币)',
                                data: [],
                                backgroundColor: 'rgba(0, 212, 170, 0.7)',
                                borderColor: 'rgba(0, 212, 170, 1)',
                                borderWidth: 1,
                                borderRadius: 6
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                } catch (e) {
                    console.warn('初始化 rewardChart 失败：', e);
                }
            }
            
            // 初始化账本图表
            const ledgerCanvas = document.getElementById('ledgerChart');
            if (ledgerCanvas) {
                try {
                    const ledgerCtx = ledgerCanvas.getContext('2d');
                    if (ledgerChart && typeof ledgerChart.destroy === 'function') ledgerChart.destroy();
                    ledgerChart = new Chart(ledgerCtx, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [{
                                label: '累计H代币收益',
                                data: [],
                                borderColor: 'rgba(0, 212, 170, 1)',
                                backgroundColor: 'rgba(0, 212, 170, 0.1)',
                                fill: true,
                                tension: 0.3,
                                borderWidth: 2,
                                pointBackgroundColor: 'rgba(0, 212, 170, 1)',
                                pointBorderColor: 'rgba(255, 255, 255, 1)',
                                pointBorderWidth: 2,
                                pointRadius: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: {
                                        color: 'rgba(255, 255, 255, 0.7)'
                                    }
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        color: 'rgba(255, 255, 255, 0.7)',
                                        callback: function(value) {
                                            return value.toLocaleString() + ' H';
                                        }
                                    },
                                    grid: {
                                        color: 'rgba(255, 255, 255, 0.1)'
                                    }
                                },
                                x: {
                                    ticks: {
                                        color: 'rgba(255, 255, 255, 0.7)'
                                    },
                                    grid: {
                                        color: 'rgba(255, 255, 255, 0.1)'
                                    }
                                }
                            }
                        }
                    });
                } catch (e) {
                    console.warn('初始化 ledgerChart 失败：', e);
                }
            }
        }

        function updateLedgerChart() {
            if (!ledgerChart || !appData.ledger || appData.ledger.length === 0) return;
            
            // 按日期升序排序
            const sortedRecords = [...appData.ledger].sort((a, b) => new Date(a.date) - new Date(b.date));
            
            const labels = [];
            const cumulativeData = [];
            let cumulativeH = 0;
            
            sortedRecords.forEach(record => {
                const date = new Date(record.date);
                labels.push(`${date.getMonth() + 1}/${date.getDate()}`);
                cumulativeH += parseFloat(record.h) || 0;
                cumulativeData.push(cumulativeH);
            });
            
            ledgerChart.data.labels = labels;
            ledgerChart.data.datasets[0].data = cumulativeData;
            ledgerChart.update();
        }

        // ===== 模态框控制 =====
        function showModal(modalId) {
            const m = document.getElementById(modalId);
            if (m) m.style.display = 'flex';
        }

        function closeModal(modalId) {
            const m = document.getElementById(modalId);
            if (m) m.style.display = 'none';
            
            // 重置转盘位置
            if (modalId === 'prizeModal' || modalId === 'multiPrizeModal') {
                const wheel = document.getElementById('wheel');
                if (wheel) {
                    wheel.style.transition = 'none';
                    wheel.style.transform = 'rotate(0deg)';
                    
                    // 重新启用过渡
                    setTimeout(() => {
                        wheel.style.transition = 'transform 3s cubic-bezier(0.2, 0.8, 0.3, 1)';
                    }, 50);
                }
            }
        }

        function showFeedbackModal() {
            showModal('feedbackModal');
        }

        // ===== 加载动画 =====
        function showLoading(show) {
            const loadingModal = document.getElementById('loadingModal');
            if (loadingModal) loadingModal.style.display = show ? 'flex' : 'none';
        }

        // ===== 消息提示 =====
        function showSuccess(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--gradient-full);
                color: var(--primary-dark);
                padding: var(--space-md) var(--space-lg);
                border-radius: var(--radius-md);
                font-weight: 600;
                z-index: 3000;
                box-shadow: var(--card-shadow);
                animation: slideDown 0.3s ease-out;
                max-width: 90%;
                text-align: center;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideUp 0.3s ease-out';
                setTimeout(() => {
                    if (toast.parentNode) toast.parentNode.removeChild(toast);
                }, 300);
            }, 3000);
        }

        function showError(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--danger);
                color: white;
                padding: var(--space-md) var(--space-lg);
                border-radius: var(--radius-md);
                font-weight: 600;
                z-index: 3000;
                box-shadow: var(--card-shadow);
                animation: slideDown 0.3s ease-out;
                max-width: 90%;
                text-align: center;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideUp 0.3s ease-out';
                setTimeout(() => {
                    if (toast.parentNode) toast.parentNode.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // ===== 动画关键帧 =====
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideDown {
                from {
                    opacity: 0;
                    transform: translate(-50%, -20px);
                }
                to {
                    opacity: 1;
                    transform: translate(-50%, 0);
                }
            }
            
            @keyframes slideUp {
                from {
                    opacity: 1;
                    transform: translate(-50%, 0);
                }
                to {
                    opacity: 0;
                    transform: translate(-50%, -20px);
                }
            }
            
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>